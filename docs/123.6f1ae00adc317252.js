"use strict";(self.webpackChunkBikeLife=self.webpackChunkBikeLife||[]).push([[123],{2123:(S,p,c)=>{c.r(p),c.d(p,{CarritoModule:()=>_});var s=c(6814),C=c(2296),d=c(2236),t=c(5879),h=c(7104),m=c(638),g=c(137),f=c(9474);const l=function(i){return[i,"ARS","symbol","1.0-0","es-AR"]};function v(i,P){if(1&i){const r=t.EpF();t.TgZ(0,"div",3)(1,"div",10),t._UZ(2,"img",11),t.TgZ(3,"div",6)(4,"p",8),t._uU(5),t._UZ(6,"br"),t._uU(7),t.ALo(8,"currency"),t.TgZ(9,"button",12),t.NdJ("click",function(){const e=t.CHM(r).$implicit,n=t.oxw();return t.KtG(n.eliminarProductoDelCarrito(e.Producto.idProducto))}),t._uU(10,"Eliminar"),t.qZA(),t._UZ(11,"br"),t._uU(12),t._UZ(13,"br"),t._uU(14),t.ALo(15,"currency"),t.qZA(),t.TgZ(16,"button",13),t.NdJ("click",function(){const e=t.CHM(r).$implicit,n=t.oxw();return t.KtG(n.restarCantidad(e))}),t._uU(17,"-"),t.qZA(),t.TgZ(18,"span"),t._uU(19),t.qZA(),t.TgZ(20,"button",13),t.NdJ("click",function(){const e=t.CHM(r).$implicit,n=t.oxw();return t.KtG(n.aumentarCantidad(e))}),t._uU(21,"+"),t.qZA()()()()}if(2&i){const r=P.$implicit;t.xp6(2),t.s9C("src",r.Producto.imagen,t.LSH),t.s9C("alt",r.Producto.nombre),t.xp6(3),t.hij(" ",r.Producto.nombre," "),t.xp6(2),t.hij(" ",t.G7q(8,7,t.VKq(19,l,r.Producto.precio))," "),t.xp6(5),t.hij(" (cantidad: ",r.Cantidad,") "),t.xp6(2),t.hij(" Subtotal: ",t.G7q(15,13,t.VKq(21,l,r.Cantidad*r.Producto.precio))," "),t.xp6(5),t.Oqu(r.Cantidad)}}const x=[{path:"carrito",component:(()=>{class i{constructor(r,o,a,e,n,u){this.database=r,this.cartService=o,this.firestoreService=a,this.carritoService=e,this.servicioRutas=n,this.authService=u,this.productosEnCarrito=[]}ngOnInit(){this.carritoService.cargarCarrito(),this.carritoService.carrito$.subscribe(r=>{this.productosEnCarrito=r}),this.cartService.carrito$.subscribe(r=>{this.productosEnCarrito=r}),this.authService.obtenerEstadoUsuario().subscribe(r=>{this.usuarioActual=r,console.log("Usuario actual:",this.usuarioActual)})}agregarProductoAlCarrito(r){const o=this.productosEnCarrito.find(a=>a.Producto.idProducto===r.idProducto);o?o.Cantidad++:this.productosEnCarrito.push({Producto:r,Cantidad:1}),this.carritoService.actualizarCarrito(this.productosEnCarrito)}aumentarCantidad(r){r.Cantidad++,this.carritoService.actualizarCarrito(this.productosEnCarrito)}restarCantidad(r){r.Cantidad>1&&r.Cantidad--,this.carritoService.actualizarCarrito(this.productosEnCarrito)}calcularTotal(){return this.productosEnCarrito.reduce((r,o)=>r+o.Producto.precio*o.Cantidad,0)}calcularSubtotal(){return this.productosEnCarrito.reduce((r,o)=>r+o.Producto.precio*o.Cantidad,0)}limpiarCarrito(){this.productosEnCarrito=[],this.cartService.actualizarCarrito(this.productosEnCarrito)}eliminarProductoDelCarrito(r){this.carritoService.eliminarProducto(r)}confirmarCompra(){if(this.authService.obtenerUid()){if(0===this.productosEnCarrito.length||!this.usuarioActual)return void console.error("No hay productos en el carrito o no hay usuario autenticado")}else alert("Debes iniciar sesi\xf3n para confirmar la compra."),this.servicioRutas.navigate(["/login"]);this.firestoreService.obtenerUsuarioPorUID(this.usuarioActual.uid).then(o=>{const a={uid:this.usuarioActual.uid,nombre:o?.nombre||"Usuario",apellido:o?.apellido||"Desconocido",email:this.usuarioActual.email},e=this.calcularSubtotal(),u={id:this.firestoreService.generarId(),usuario:a,productos:this.productosEnCarrito,fecha:new Date,totalprecio:e,fechaEntrega:new Date((new Date).setDate((new Date).getDate()+7))};this.firestoreService.agregarPedido(u).then(()=>{console.log("Pedido guardado con \xe9xito"),this.limpiarCarrito(),alert("Se realiz\xf3 la compra con \xe9xito")}).catch(y=>{console.error("Error al guardar el pedido:",y),alert("Algo sali\xf3 mal :(")})})}static#t=this.\u0275fac=function(o){return new(o||i)(t.Y36(h.ST),t.Y36(m.z),t.Y36(g.C),t.Y36(m.z),t.Y36(d.F0),t.Y36(f.e))};static#r=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-carrito"]],decls:18,vars:10,consts:[[1,"row"],["class","col-lg-3",4,"ngFor","ngForOf"],[1,"col-lg-12"],[1,"col-lg-3"],[1,"card"],[1,"card-header"],[1,"card-body"],[1,"card-title"],[1,"card-text"],[1,"btn",3,"click"],[1,"card",2,"width","18rem"],[1,"card-img-top",3,"src","alt"],[3,"click"],["type","button",1,"btn","btn-primary",3,"click"]],template:function(o,a){1&o&&(t.TgZ(0,"p"),t._uU(1,"carrito works!"),t.qZA(),t.TgZ(2,"div",0),t.YNc(3,v,22,23,"div",1),t.qZA(),t.TgZ(4,"div",0)(5,"div",2)(6,"div",3)(7,"div",4)(8,"h5",5),t._uU(9," Total de la compra"),t.qZA(),t.TgZ(10,"div",6)(11,"h5",7),t._uU(12,"subtotal"),t.qZA(),t.TgZ(13,"p",8),t._uU(14),t.ALo(15,"currency"),t.qZA(),t.TgZ(16,"button",9),t.NdJ("click",function(){return a.confirmarCompra()}),t._uU(17,"Confirmar Compra"),t.qZA()()()()()()),2&o&&(t.xp6(3),t.Q6J("ngForOf",a.productosEnCarrito),t.xp6(11),t.Oqu(t.G7q(15,2,t.VKq(8,l,a.calcularTotal()))))},dependencies:[s.sg,s.H9],styles:[".mat-toolbar[_ngcontent-%COMP%]{background-color:var(--primary-color);color:var(--text-color)}button[_ngcontent-%COMP%]{background-color:var(--primary-color);color:var(--input-color)}button[_ngcontent-%COMP%]:hover{background-color:var(--accent-color);color:var(--text-color)}.mat-warn[_ngcontent-%COMP%]{background-color:var(--warn-color);color:var(--text-color)}.mat-card[_ngcontent-%COMP%], .mat-menu[_ngcontent-%COMP%]{background-color:var(--background-color);color:var(--text-color)}.mat-slide-toggle-thumb[_ngcontent-%COMP%]{background-color:var(--primary-color)}.mat-slide-toggle-bar[_ngcontent-%COMP%]{background-color:var(--accent-color)}.col-lg-12[_ngcontent-%COMP%]{justify-content:center;display:flex}.row[_ngcontent-%COMP%]{animation-duration:2.7s;animation-name:_ngcontent-%COMP%_animCart;margin:0;display:flex;flex-wrap:wrap;justify-content:flex-start}@keyframes _ngcontent-%COMP%_animCart{0%{margin-left:100%;width:100%}to{margin-left:0%;width:100%}}.col[_ngcontent-%COMP%]{flex:0 0 calc(33.333% - 20px);margin:10px;border-radius:6px;overflow:hidden;background:var(--primary-color);box-shadow:0 1px 10px #0003;cursor:default;transition:all .4s ease;display:flex;flex-direction:column}.col[_ngcontent-%COMP%]:hover{box-shadow:5px 5px 20px #0006;transform:translateY(-3%)}.card-image[_ngcontent-%COMP%]{width:100%;height:200px;object-fit:contain;display:block;margin:0 auto;border:none;background-color:var(--background-color)}.mat-card-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}@media (min-width: 768px){.mat-card[_ngcontent-%COMP%]{height:350px}}@media (max-width: 768px){.col[_ngcontent-%COMP%]{flex:0 0 calc(50% - 20px);max-width:calc(50% - 20px)}}@media (max-width: 576px){.col[_ngcontent-%COMP%]{flex:0 0 calc(100% - 20px);max-width:calc(100% - 20px)}}"]})}return i})()}];let b=(()=>{class i{static#t=this.\u0275fac=function(o){return new(o||i)};static#r=this.\u0275mod=t.oAB({type:i});static#o=this.\u0275inj=t.cJS({imports:[d.Bz.forChild(x),d.Bz]})}return i})(),_=(()=>{class i{static#t=this.\u0275fac=function(o){return new(o||i)};static#r=this.\u0275mod=t.oAB({type:i});static#o=this.\u0275inj=t.cJS({imports:[s.ez,b,C.ot]})}return i})()}}]);